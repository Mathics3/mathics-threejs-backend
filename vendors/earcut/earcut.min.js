export default function(e){var n,r,t,i,x,a,o,u=e.length,l=ll(e,0,u,!0),v=[];if(!l||l.next===l.prev)return v;if(e.length>240){n=t=e[0],r=i=e[1];for(let s=3;s<u;s+=3)(x=e[s])<n&&(n=x),(a=e[s+1])<r&&(r=a),x>t&&(t=x),a>i&&(i=a);o=0!==(o=Math.max(t-n,i-r))?1/o:0}return el(l,v,n,r,o),v}function ll(e,n,r,t){var i,x;if(t===s(e,n,r)>0)for(i=n;i<r;i+=3)x=id(i,e[i],e[i+1],x);else for(i=r-3;i>=n;i-=3)x=id(i,e[i],e[i+1],x);return x&&eq(x,x.next)&&(b(x),x=x.next),x}function fp(e,n){if(!e)return e;n||(n=e);var r,t=e;do{if(r=!1,t.steiner||!eq(t,t.next)&&0!==aa(t.prev,t,t.next))t=t.next;else{if(b(t),(t=n=t.prev)===t.next)break;r=!0}}while(r||t!==n);return n}function el(e,n,r,t,i,x){if(e){!x&&i&&c(e,r,t,i);for(var a,o,u=e;e.prev!==e.next;)if(a=e.prev,o=e.next,i?d(e,r,t,i):g(e))n.push(a.i/3),n.push(e.i/3),n.push(o.i/3),b(e),e=o.next,u=o.next;else if((e=o)===u){x?1===x?el(e=k(fp(e),n),n,r,t,i,2):2===x&&h(e,n,r,t,i):el(fp(e),n,r,t,i,1);break}}}function g(e){var n=e.prev,r=e,t=e.next;if(aa(n,r,t)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(j(n.x,n.y,r.x,r.y,t.x,t.y,i.x,i.y)&&aa(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function d(e,n,r,t){var i=e.prev,x=e,a=e.next;if(aa(i,x,a)>=0)return!1;for(var o=i.x<x.x?i.x<a.x?i.x:a.x:x.x<a.x?x.x:a.x,u=i.y<x.y?i.y<a.y?i.y:a.y:x.y<a.y?x.y:a.y,l=i.x>x.x?i.x>a.x?i.x:a.x:x.x>a.x?x.x:a.x,v=i.y>x.y?i.y>a.y?i.y:a.y:x.y>a.y?x.y:a.y,s=m(o,u,n,r,t),y=m(l,v,n,r,t),p=e.prevZ,f=e.nextZ;p&&p.z>=s&&f&&f.z<=y;){if(p!==e.prev&&p!==e.next&&j(i.x,i.y,x.x,x.y,a.x,a.y,p.x,p.y)&&aa(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&j(i.x,i.y,x.x,x.y,a.x,a.y,f.x,f.y)&&aa(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=s;){if(p!==e.prev&&p!==e.next&&j(i.x,i.y,x.x,x.y,a.x,a.y,p.x,p.y)&&aa(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=y;){if(f!==e.prev&&f!==e.next&&j(i.x,i.y,x.x,x.y,a.x,a.y,f.x,f.y)&&aa(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function k(e,n){var r=e;do{var t=r.prev,i=r.next.next;!eq(t,i)&&ab(t,r,r.next,i)&&ad(t,i)&&ad(i,t)&&(n.push(t.i/3),n.push(r.i/3),n.push(i.i/3),b(r),b(r.next),r=e=i),r=r.next}while(r!==e);return fp(r)}function h(e,n,r,t,i){var x=e;do{for(var a=x.next.next;a!==x.prev;){if(x.i!==a.i&&ac(x,a)){var o=w(x,a);return x=fp(x,x.next),o=fp(o,o.next),el(x,n,r,t,i),void el(o,n,r,t,i)}a=a.next}x=x.next}while(x!==e)}function c(e,n,r,t){var i=e;do{null===i.z&&(i.z=m(i.x,i.y,n,r,t)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,q(i)}function q(e){var n,r,t,i,x,a,o,u,l=1;do{for(r=e,e=null,x=null,a=0;r;){for(a++,t=r,o=0,n=0;n<l&&(o++,t=t.nextZ);n++);for(u=l;o>0||u>0&&t;)0!==o&&(0===u||!t||r.z<=t.z)?(i=r,r=r.nextZ,o--):(i=t,t=t.nextZ,u--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;r=t}x.nextZ=null,l*=2}while(a>1);return e}function m(e,n,r,t,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*i)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function j(e,n,r,t,i,x,a,o){return(i-a)*(n-o)-(e-a)*(x-o)>=0&&(e-a)*(t-o)-(r-a)*(n-o)>=0&&(r-a)*(x-o)-(i-a)*(t-o)>=0}function ac(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!ap(e,n)&&(ad(e,n)&&ad(n,e)&&ae(e,n)&&(aa(e.prev,e,n.prev)||aa(e,n.prev,n))||eq(e,n)&&aa(e.prev,e,e.next)>0&&aa(n.prev,n,n.next)>0)}function aa(e,n,r){return(n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y)}function eq(e,n){return e.x===n.x&&e.y===n.y}function ab(e,n,r,t){var i=sn(aa(e,n,r)),x=sn(aa(e,n,t)),a=sn(aa(r,t,e)),o=sn(aa(r,t,n));return i!==x&&a!==o||!(0!==i||!os(e,r,n))||!(0!==x||!os(e,t,n))||!(0!==a||!os(r,e,t))||!(0!==o||!os(r,n,t))}function os(e,n,r){return n.x<=Math.max(e.x,r.x)&&n.x>=Math.min(e.x,r.x)&&n.y<=Math.max(e.y,r.y)&&n.y>=Math.min(e.y,r.y)}function sn(e){return e>0?1:e<0?-1:0}function ap(e,n){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&ab(r,r.next,e,n))return!0;r=r.next}while(r!==e);return!1}function ad(e,n){return aa(e.prev,e,e.next)<0?aa(e,n,e.next)>=0&&aa(e,e.prev,n)>=0:aa(e,n,e.prev)<0||aa(e,e.next,n)<0}function ae(e,n){var r=e,t=!1,i=(e.x+n.x)/2,x=(e.y+n.y)/2;do{r.y>x!=r.next.y>x&&r.next.y!==r.y&&i<(r.next.x-r.x)*(x-r.y)/(r.next.y-r.y)+r.x&&(t=!t),r=r.next}while(r!==e);return t}function w(e,n){var r=new nd(e.i,e.x,e.y),t=new nd(n.i,n.x,n.y),i=e.next,x=n.prev;return e.next=n,n.prev=e,r.next=i,i.prev=r,t.next=r,r.prev=t,x.next=t,t.prev=x,t}function id(e,n,r,t){var i=new nd(e,n,r);return t?(i.next=t.next,i.prev=t,t.next.prev=i,t.next=i):(i.prev=i,i.next=i),i}function b(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function nd(e,n,r){this.i=e,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function s(e,n,r){for(var t=0,i=n,x=r-3;i<r;i+=3)t+=(e[x]-e[i])*(e[i+1]+e[x+1]),x=i;return t}